function [ExperimentData,LagVector,Delta]=generate_experiment_set(varargin)
%----------------------------------------------------------------------maca
%------------------------------------------------------------------<header>
%-----------------------------------------------------------------<\header>
% Create an input parser object to handle and validate input arguments
P=inputParser; 
% Define default values and/or validators for various parameters
autoRegressionCoefficients=[0.9,0.9,0.1]';
dLower=[30,25,20,15,10,5,0,-5,-10];
dUpper=[60,55,50,45,40,35,30,25,20];
settingOutliers=false;
settingStartSet=autoRegressionCoefficients;
settingYNoise=0.05;
settingLagNumber=5;
settingXNoise=[0.05,0.05,0.05];
settingCoeffSigma=0.01;
settingRngSeed=1;
settingTestRngSeed=now;
settingRngGenerator='twister';
validScalarNonnegNum = @(x) isnumeric(x) && all(all(x >= 0));
% Adding parameters to the input parser with default values and validators
addParameter(P,'autoRegressionCoefficients',autoRegressionCoefficients);
addParameter(P,'dLower',dLower,validScalarNonnegNum);
addParameter(P,'dUpper',dUpper,validScalarNonnegNum);
addParameter(P,'settingOutliers',settingOutliers,@(x) islogical(x));
addParameter(P,'settingStartSet',settingStartSet,@(x) isnumeric(x));
addParameter(P,'xNoise',settingXNoise,@(x) isnumeric(x));
addParameter(P,'yNoise',settingYNoise,@(x) isnumeric(x));
addParameter(P,'lagNum',settingLagNumber,@(x) isnumeric(x));
addParameter(P,'coeffSigma',settingCoeffSigma,@(x) isnumeric(x));
addParameter(P,'rngSeed',settingRngSeed,@(x) isnumeric(x),'PartialMatchPriority',1);
addParameter(P,'rngGenerator',settingRngGenerator,'PartialMatchPriority',3);
addParameter(P,'testRngSeed',settingTestRngSeed,@(x) isnumeric(x),'PartialMatchPriority',2);
% Parse the input arguments
parse(P,varargin{:});
% Extract parsed values to variables
dLower=P.Results.dLower;
dUpper=P.Results.dUpper;
optionOutliers=P.Results.settingOutliers;
optionStartSet=P.Results.settingStartSet;
optionYNoise=P.Results.yNoise;
optionLagNumber=P.Results.lagNum;
optionXNoise=P.Results.xNoise;
optionCoeffSigma=P.Results.coeffSigma;
rngSeed=P.Results.rngSeed;
rngGenerator=P.Results.rngGenerator;
testSeed=P.Results.testRngSeed;
%%

%% Set the random number generator for reproducibility
rng(rngSeed,rngGenerator);
% Generate synthetic data  (100 data points)
[xSize1Calib,ttXSize1Calib,ttYSize1Calib,LagVector,~,Delta]=generate_synthetic_data(100,1,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'coeffSigma',optionCoeffSigma,...
    'deltaLower',dLower...
    );
% Generate synthetic data  (1000 data points)
[xSize2Calib,ttXSize2Calib,ttYSize2Calib]=generate_synthetic_data(1000,1,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'coeffSigma',optionCoeffSigma,...
    'deltaUpper',dUpper,...
    'deltaLower',dLower...
    );
% Generate synthetic data  (10000 data points)
[xSize3Calib,ttXSize3Calib,ttYSize3Calib]=generate_synthetic_data(10000,1,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'coeffSigma',optionCoeffSigma,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'deltaLower',dLower...
    );
% Set RNG for test data generation
rng(testSeed,'twister')
% Generate test data (10000 data points)
[xSize3Test,ttXSize3Test,ttYSize3Test]=generate_synthetic_data(10000,1,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'coeffSigma',optionCoeffSigma,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'deltaLower',dLower...
    );
%%%
% Store calibration and test data in structured format for different experiment setups
% Calibration data for 'H1' configuration
    ExperimentData.H1.hundred.calib.X=xSize1Calib;
    ExperimentData.H1.hundred.calib.TT=ttXSize1Calib;
    ExperimentData.H1.hundred.calib.C1=ttYSize1Calib.y_lin;
    ExperimentData.H1.hundred.calib.C2=ttYSize1Calib.y_interactions;
    ExperimentData.H1.hundred.calib.C3=ttYSize1Calib.y_enzyme;
   ExperimentData.H1.thousand.calib.X=xSize2Calib;
   ExperimentData.H1.thousand.calib.TT=ttXSize2Calib;
   ExperimentData.H1.thousand.calib.C1=ttYSize2Calib.y_lin;
   ExperimentData.H1.thousand.calib.C2=ttYSize2Calib.y_interactions;
   ExperimentData.H1.thousand.calib.C3=ttYSize2Calib.y_enzyme;
ExperimentData.H1.tenThousand.calib.X=xSize3Calib;
ExperimentData.H1.tenThousand.calib.TT=ttXSize3Calib;
ExperimentData.H1.tenThousand.calib.C1=ttYSize3Calib.y_lin;
ExperimentData.H1.tenThousand.calib.C2=ttYSize3Calib.y_interactions;
ExperimentData.H1.tenThousand.calib.C3=ttYSize3Calib.y_enzyme;
% Test data for 'H1' configuration
    ExperimentData.H1.hundred.test.X=xSize3Test;
    ExperimentData.H1.hundred.test.TT=ttXSize3Test;
    ExperimentData.H1.hundred.test.C1=ttYSize3Test.y_lin;
    ExperimentData.H1.hundred.test.C2=ttYSize3Test.y_interactions;
    ExperimentData.H1.hundred.test.C3=ttYSize3Test.y_enzyme;
   ExperimentData.H1.thousand.test.X=xSize3Test;
   ExperimentData.H1.thousand.test.TT=ttXSize3Test;
   ExperimentData.H1.thousand.test.C1=ttYSize3Test.y_lin;
   ExperimentData.H1.thousand.test.C2=ttYSize3Test.y_interactions;
   ExperimentData.H1.thousand.test.C3=ttYSize3Test.y_enzyme;
ExperimentData.H1.tenThousand.test.X=xSize3Test;
ExperimentData.H1.tenThousand.test.TT=ttXSize3Test;
ExperimentData.H1.tenThousand.test.C1=ttYSize3Test.y_lin;
ExperimentData.H1.tenThousand.test.C2=ttYSize3Test.y_interactions;
ExperimentData.H1.tenThousand.test.C3=ttYSize3Test.y_enzyme;
%% Set the random number generator for reproducibility
rng(rngSeed,rngGenerator);
% Generate synthetic data  (100 data points)
autoRegressionCoefficients=[0.4,0.4,0.1]';
optionStartSet=autoRegressionCoefficients;
[xSize1Calib,ttXSize1Calib,ttYSize1Calib]=generate_synthetic_data(100,1,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'coeffSigma',optionCoeffSigma,...
    'deltaUpper',dUpper,...
    'deltaLower',dLower...
    );
% Generate synthetic data  (1000 data points)
[xSize2Calib,ttXSize2Calib,ttYSize2Calib]=generate_synthetic_data(1000,1,...
    'Outliers',settingOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'coeffSigma',optionCoeffSigma,...
    'deltaLower',dLower...
    );
% Generate synthetic data  (10000 data points)
[xSize3Calib,ttXSize3Calib,ttYSize3Calib]=generate_synthetic_data(10000,1,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'coeffSigma',optionCoeffSigma,...
    'deltaLower',dLower...
    );
% Set RNG for test data generation
rng(testSeed,'twister')
% Generate test data (10000 data points)
[xSize3Test,ttXSize3Test,ttYSize3Test]=generate_synthetic_data(10000,1,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'coeffSigma',optionCoeffSigma,...
    'deltaLower',dLower...
    );
% Store calibration and test data in structured format for different experiment setups
% Calibration data for 'L1' configuration
    ExperimentData.L1.hundred.calib.X=xSize1Calib;
    ExperimentData.L1.hundred.calib.TT=ttXSize1Calib;
    ExperimentData.L1.hundred.calib.C1=ttYSize1Calib.y_lin;
    ExperimentData.L1.hundred.calib.C2=ttYSize1Calib.y_interactions;
    ExperimentData.L1.hundred.calib.C3=ttYSize1Calib.y_enzyme;
   ExperimentData.L1.thousand.calib.X=xSize2Calib;
   ExperimentData.L1.thousand.calib.TT=ttXSize2Calib;
   ExperimentData.L1.thousand.calib.C1=ttYSize2Calib.y_lin;
   ExperimentData.L1.thousand.calib.C2=ttYSize2Calib.y_interactions;
   ExperimentData.L1.thousand.calib.C3=ttYSize2Calib.y_enzyme;
ExperimentData.L1.tenThousand.calib.X=xSize3Calib;
ExperimentData.L1.tenThousand.calib.TT=ttXSize3Calib;
ExperimentData.L1.tenThousand.calib.C1=ttYSize3Calib.y_lin;
ExperimentData.L1.tenThousand.calib.C2=ttYSize3Calib.y_interactions;
ExperimentData.L1.tenThousand.calib.C3=ttYSize3Calib.y_enzyme;
% Test data for 'L1' configuration
    ExperimentData.L1.hundred.test.X=xSize3Test;
    ExperimentData.L1.hundred.test.TT=ttXSize3Test;
    ExperimentData.L1.hundred.test.C1=ttYSize3Test.y_lin;
    ExperimentData.L1.hundred.test.C2=ttYSize3Test.y_interactions;
    ExperimentData.L1.hundred.test.C3=ttYSize3Test.y_enzyme;
   ExperimentData.L1.thousand.test.X=xSize3Test;
   ExperimentData.L1.thousand.test.TT=ttXSize3Test;
   ExperimentData.L1.thousand.test.C1=ttYSize3Test.y_lin;
   ExperimentData.L1.thousand.test.C2=ttYSize3Test.y_interactions;
   ExperimentData.L1.thousand.test.C3=ttYSize3Test.y_enzyme;
ExperimentData.L1.tenThousand.test.X=xSize3Test;
ExperimentData.L1.tenThousand.test.TT=ttXSize3Test;
ExperimentData.L1.tenThousand.test.C1=ttYSize3Test.y_lin;
ExperimentData.L1.tenThousand.test.C2=ttYSize3Test.y_interactions;
ExperimentData.L1.tenThousand.test.C3=ttYSize3Test.y_enzyme;
%% Set the random number generator for reproducibility
rng(rngSeed,rngGenerator);
% Generate synthetic data  (100 data points)
autoRegressionCoefficients=[0.75,0.75,0.15;0.20,0.20,0.10]';
optionStartSet=autoRegressionCoefficients;
[xSize1Calib,ttXSize1Calib,ttYSize1Calib]=generate_synthetic_data(100,2,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'coeffSigma',optionCoeffSigma,...
    'deltaUpper',dUpper,...
    'deltaLower',dLower...
    );
% Generate synthetic data  (1000 data
% points)
[xSize2Calib,ttXSize2Calib,ttYSize2Calib]=generate_synthetic_data(1000,2,...
    'Outliers',settingOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'coeffSigma',optionCoeffSigma,...
    'deltaLower',dLower...
    );
% Generate synthetic data  (10000 data points)
[xSize3Calib,ttXSize3Calib,ttYSize3Calib]=generate_synthetic_data(10000,2,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'coeffSigma',optionCoeffSigma,...
    'deltaLower',dLower...
    );
% Set RNG for test data generation
rng(testSeed,'twister')
% Generate test data (10000 data points)
[xSize3Test,ttXSize3Test,ttYSize3Test]=generate_synthetic_data(10000,2,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'coeffSigma',optionCoeffSigma,...
    'deltaLower',dLower...
    );
% Store calibration and test data in structured format for different experiment setups
% Calibration data for 'H2' configuration
    ExperimentData.H2.hundred.calib.X=xSize1Calib;
    ExperimentData.H2.hundred.calib.TT=ttXSize1Calib;
    ExperimentData.H2.hundred.calib.C1=ttYSize1Calib.y_lin;
    ExperimentData.H2.hundred.calib.C2=ttYSize1Calib.y_interactions;
    ExperimentData.H2.hundred.calib.C3=ttYSize1Calib.y_enzyme;
   ExperimentData.H2.thousand.calib.X=xSize2Calib;
   ExperimentData.H2.thousand.calib.TT=ttXSize2Calib;
   ExperimentData.H2.thousand.calib.C1=ttYSize2Calib.y_lin;
   ExperimentData.H2.thousand.calib.C2=ttYSize2Calib.y_interactions;
   ExperimentData.H2.thousand.calib.C3=ttYSize2Calib.y_enzyme;
ExperimentData.H2.tenThousand.calib.X=xSize3Calib;
ExperimentData.H2.tenThousand.calib.TT=ttXSize3Calib;
ExperimentData.H2.tenThousand.calib.C1=ttYSize3Calib.y_lin;
ExperimentData.H2.tenThousand.calib.C2=ttYSize3Calib.y_interactions;
ExperimentData.H2.tenThousand.calib.C3=ttYSize3Calib.y_enzyme;
% Test data for 'H2' configuration
    ExperimentData.H2.hundred.test.X=xSize3Test;
    ExperimentData.H2.hundred.test.TT=ttXSize3Test;
    ExperimentData.H2.hundred.test.C1=ttYSize3Test.y_lin;
    ExperimentData.H2.hundred.test.C2=ttYSize3Test.y_interactions;
    ExperimentData.H2.hundred.test.C3=ttYSize3Test.y_enzyme;
   ExperimentData.H2.thousand.test.X=xSize3Test;
   ExperimentData.H2.thousand.test.TT=ttXSize3Test;
   ExperimentData.H2.thousand.test.C1=ttYSize3Test.y_lin;
   ExperimentData.H2.thousand.test.C2=ttYSize3Test.y_interactions;
   ExperimentData.H2.thousand.test.C3=ttYSize3Test.y_enzyme;
ExperimentData.H2.tenThousand.test.X=xSize3Test;
ExperimentData.H2.tenThousand.test.TT=ttXSize3Test;
ExperimentData.H2.tenThousand.test.C1=ttYSize3Test.y_lin;
ExperimentData.H2.tenThousand.test.C2=ttYSize3Test.y_interactions;
ExperimentData.H2.tenThousand.test.C3=ttYSize3Test.y_enzyme;
%% Set the random number generator for reproducibility
rng(rngSeed,rngGenerator);
% Generate synthetic data  (100 data points)
autoRegressionCoefficients=[0.55,0.55,0.15;0.20,0.20,0.10]';
optionStartSet=autoRegressionCoefficients;
[xSize1Calib,ttXSize1Calib,ttYSize1Calib]=generate_synthetic_data(100,2,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'coeffSigma',optionCoeffSigma,...
    'deltaUpper',dUpper,...
    'deltaLower',dLower...
    );
% Generate synthetic data  (1000 data points)
[xSize2Calib,ttXSize2Calib,ttYSize2Calib]=generate_synthetic_data(1000,2,...
    'Outliers',settingOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'coeffSigma',optionCoeffSigma,...
    'deltaLower',dLower...
    );
% Generate synthetic data  (10000 data points)
[xSize3Calib,ttXSize3Calib,ttYSize3Calib]=generate_synthetic_data(10000,2,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'coeffSigma',optionCoeffSigma,...
    'deltaLower',dLower...
    );
% Set RNG for test data generation
rng(testSeed,'twister')
% Generate test data (10000 data points)
[xSize3Test,ttXSize3Test,ttYSize3Test]=generate_synthetic_data(10000,2,...
    'Outliers',optionOutliers,...
    'fullSet',optionStartSet,...
    'YNoise',optionYNoise,...
    'lagNum',optionLagNumber,...
    'XNoise',optionXNoise,...
    'deltaUpper',dUpper,...
    'coeffSigma',optionCoeffSigma,...
    'deltaLower',dLower...
    );
% Store calibration and test data in structured format for different experiment setups
% Calibration data for 'L2' configuration
    ExperimentData.L2.hundred.calib.X=xSize1Calib;
    ExperimentData.L2.hundred.calib.TT=ttXSize1Calib;
    ExperimentData.L2.hundred.calib.C1=ttYSize1Calib.y_lin;
    ExperimentData.L2.hundred.calib.C2=ttYSize1Calib.y_interactions;
    ExperimentData.L2.hundred.calib.C3=ttYSize1Calib.y_enzyme;
   ExperimentData.L2.thousand.calib.X=xSize2Calib;
   ExperimentData.L2.thousand.calib.TT=ttXSize2Calib;
   ExperimentData.L2.thousand.calib.C1=ttYSize2Calib.y_lin;
   ExperimentData.L2.thousand.calib.C2=ttYSize2Calib.y_interactions;
   ExperimentData.L2.thousand.calib.C3=ttYSize2Calib.y_enzyme;
ExperimentData.L2.tenThousand.calib.X=xSize3Calib;
ExperimentData.L2.tenThousand.calib.TT=ttXSize3Calib;
ExperimentData.L2.tenThousand.calib.C1=ttYSize3Calib.y_lin;
ExperimentData.L2.tenThousand.calib.C2=ttYSize3Calib.y_interactions;
ExperimentData.L2.tenThousand.calib.C3=ttYSize3Calib.y_enzyme;
%test
    ExperimentData.L2.hundred.test.X=xSize3Test;
    ExperimentData.L2.hundred.test.TT=ttXSize3Test;
    ExperimentData.L2.hundred.test.C1=ttYSize3Test.y_lin;
    ExperimentData.L2.hundred.test.C2=ttYSize3Test.y_interactions;
    ExperimentData.L2.hundred.test.C3=ttYSize3Test.y_enzyme;
   ExperimentData.L2.thousand.test.X=xSize3Test;
   ExperimentData.L2.thousand.test.TT=ttXSize3Test;
   ExperimentData.L2.thousand.test.C1=ttYSize3Test.y_lin;
   ExperimentData.L2.thousand.test.C2=ttYSize3Test.y_interactions;
   ExperimentData.L2.thousand.test.C3=ttYSize3Test.y_enzyme;
ExperimentData.L2.tenThousand.test.X=xSize3Test;
ExperimentData.L2.tenThousand.test.TT=ttXSize3Test;
ExperimentData.L2.tenThousand.test.C1=ttYSize3Test.y_lin;
ExperimentData.L2.tenThousand.test.C2=ttYSize3Test.y_interactions;
ExperimentData.L2.tenThousand.test.C3=ttYSize3Test.y_enzyme;







